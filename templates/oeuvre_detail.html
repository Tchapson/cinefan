<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>{{ oeuvre.titre }} â€“ CinÃ©Fan</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<header class="site-header">
    <div class="logo">CinÃ©Fan</div>

    <nav class="main-nav">
        <a href="{{ url_for('accueil') }}">Accueil</a>
        <a href="{{ url_for('oeuvres') }}">Å’uvres</a>
        <a href="{{ url_for('recherche') }}">Recherche</a>
        <a href="{{ url_for('artistes') }}">Artistes</a>

        {% if session.get('user_id') %}
            <a href="{{ url_for('favoris') }}">Mes favoris</a>
            <a href="{{ url_for('profil') }}" class="user-tag">
                ðŸ‘¤ {{ session['pseudo'] }}
            </a>
            <form action="{{ url_for('deconnexion') }}" method="post" style="display:inline;">
                <button type="submit" class="logout-btn">DÃ©connexion</button>
            </form>
        {% else %}
            <a href="{{ url_for('connexion') }}">Connexion</a>
            <a href="{{ url_for('inscription') }}">Inscription</a>
        {% endif %}
    </nav>
</header>

<main>

<h1>{{ oeuvre.titre }}</h1>

<p class="muted">
    {{ oeuvre.type_oeuvre }}
    {% if oeuvre.numero_volet_saison %}
        â€“ Volet/saison nÂ° {{ oeuvre.numero_volet_saison }}
    {% endif %}
    â€“ {{ oeuvre.date_creation }}
</p>

{% if genres %}
<p>
    <strong>Genres :</strong>
    {% for g in genres %}
        {{ g.nom_cat }}{% if not loop.last %}, {% endif %}
    {% endfor %}
</p>
{% endif %}

{% if oeuvre.description_oeuvre %}
<p>{{ oeuvre.description_oeuvre }}</p>
{% endif %}

<hr>

<!-- ======================== -->
<!--       RÃ‰ALISATEURS       -->
<!-- ======================== -->
{% if realisateurs %}
<h3>RÃ©alisateur(s)</h3>
<ul class="list">
    {% for r in realisateurs %}
    <li>
        <a href="{{ url_for('artiste_detail', id_artiste=r.id_artiste) }}">
            {{ r.prenom }} {{ r.nom }}
        </a>
    </li>
    {% endfor %}
</ul>
{% endif %}

<!-- ======================== -->
<!--         ACTEURS          -->
<!-- ======================== -->
{% if acteurs %}
<h3>Acteurs & personnages</h3>
<ul class="list">
    {% for a in acteurs %}
    <li>
        <a href="{{ url_for('artiste_detail', id_artiste=a.id_artiste) }}">
            {{ a.prenom }} {{ a.nom }}
        </a>
        â€” <em>{{ a.personnage }}</em>
    </li>
    {% endfor %}
</ul>
{% endif %}

<!-- ======================== -->
<!--      LIENS ENTRE OEUVRES -->
<!-- ======================== -->
{% if liens %}
<h3>Liens avec d'autres Å“uvres</h3>
<ul class="list">
    {% for l in liens %}
    <li>
        {{ l.type_lien }} :
        <a href="{{ url_for('oeuvre_detail', id_oeuvre=l.id_liee) }}">
            {{ l.titre }}
        </a>
    </li>
    {% endfor %}
</ul>
{% endif %}

<hr>

<!-- ======================== -->
<!--   FAVORIS & COMMENTAIRES -->
<!-- ======================== -->

{% if session.get('user_id') %}

    {% if est_favori %}
    <form action="{{ url_for('retirer_favori', id_oeuvre=oeuvre.id_oeuvre) }}" method="post">
        <button type="submit" class="btn-secondary">Retirer des favoris</button>
    </form>
    {% else %}
    <form action="{{ url_for('ajouter_favori', id_oeuvre=oeuvre.id_oeuvre) }}" method="post">
        <button type="submit" class="btn-primary">Ajouter aux favoris</button>
    </form>
    {% endif %}


    <h3>Ajouter un commentaire</h3>
    <form action="{{ url_for('ajouter_commentaire', id_oeuvre=oeuvre.id_oeuvre) }}" method="post">
        <textarea name="contenu" rows="3" placeholder="Votre avis..." required></textarea>
        <button type="submit">Envoyer</button>
    </form>

{% else %}

<p class="muted">
    <a href="{{ url_for('connexion') }}">Connectez-vous</a> pour commenter ou ajouter aux favoris.
</p>

{% endif %}

<h3>Commentaires</h3>
<ul class="list">
    {% for c in commentaires %}
    <li>
        <strong>{{ c.pseudo }}</strong>
        â€“ <span class="muted">{{ c.date_commentaire }}</span><br>
        {{ c.contenu }}
    </li>
    {% else %}
    <p>Aucun commentaire pour le moment.</p>
    {% endfor %}
</ul>

</main>

</body>
</html>
